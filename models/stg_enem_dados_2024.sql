-- Este comando diz ao dbt para criar uma TABELA no BigQuery
{{ config(materialized='table') }}

SELECT 
    NU_SEQUENCIAL AS id,
    NU_ANO AS year_test,
    CO_ESCOLA AS id_school,
    CO_MUNICIPIO_ESC,
    NO_MUNICIPIO_ESC,
    CO_UF_ESC,
    SG_UF_ESC,
    TP_DEPENDENCIA_ADM_ESC,
    TP_LOCALIZACAO_ESC,
    TP_SIT_FUNC_ESC,
    CO_MUNICIPIO_PROVA,
    NO_MUNICIPIO_PROVA,
    CO_UF_PROVA,
    SG_UF_PROVA,
    TP_PRESENCA_CN,
    TP_PRESENCA_CH,
    TP_PRESENCA_LC,
    TP_PRESENCA_MT,
    CO_PROVA_CN,
    CO_PROVA_CH,
    CO_PROVA_LC,
    CO_PROVA_MT,
    NU_NOTA_CN,
    NU_NOTA_CH,
    NU_NOTA_LC,
    NU_NOTA_MT,
    TX_RESPOSTAS_CN,
    TX_RESPOSTAS_CH,
    TX_RESPOSTAS_LC,
    TX_RESPOSTAS_MT,
    TP_LINGUA,
    TX_GABARITO_CN,
    TX_GABARITO_CH,
    TX_GABARITO_LC,
    TX_GABARITO_MT,
    TP_STATUS_REDACAO,
    NU_NOTA_COMP1,
    NU_NOTA_COMP2,
    NU_NOTA_COMP3,
    NU_NOTA_COMP4,
    NU_NOTA_COMP5,
    NU_NOTA_REDACAO
FROM {{ source('raw_enem', 'stg_enem_2024') }}